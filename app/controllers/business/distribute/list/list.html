<div>
  <div class="toolbar">
    <button class="btn btn-default-light" ng-click="vm.batchDistribute()">
      <i class="icon icon-distribute"></i>
      <span>批量分配检测人员</span>
    </button>
    <div class="pull-right">
      <input class="input" placeholder="请输入报告编号查询" ng-model="vm.searchConditions.reportId" ng-keyup="vm.eventSearch($event)">
      <button class="btn btn-default-dark" ng-click="vm.search()">
        <i class="fa fa-search"></i>
        <span>查询</span>
      </button>
    </div>
  </div>

  <table class="pt-table" st-table="vm.checkItems" st-pipe="vm.getCiList">
    <thead st-search-watch="vm.searchObject">
      <tr>
        <th style="width: 60px;">
          <input type="checkbox" ng-click="vm.selectAll()" ng-model="vm.allSelected"> 序号
        </th>
        <th>
          <div st-sort="name">名称
            <i class="fa fa-sort"></i>
          </div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div st-sort="method">检测方法
            <i class="fa fa-sort"></i>
          </div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>单位</div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>标准值</div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>默认价格</div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>状态</div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>分包</div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>检测部门</div>
          <adjust-line></adjust-line>
        </th>
        <th>
          <div>检测员</div>
          <adjust-line></adjust-line>
        </th>
        <th>更新时间</th>
        <th style="width: 100px">操作</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-if="vm.ciLoading">
        <td colspan="12" class="text-center">
          <i class="fa fa-pulse fa-spinner"></i>
        </td>
      </tr>
      <tr ng-if="!vm.ciLoading && vm.checkItems.length == 0">
        <td colspan="12" class="text-center">暂无检测项</td>
      </tr>
      <tr ng-repeat="item in vm.checkItems track by item.id" ng-if="!vm.ciLoading">
        <td>
          <input type="checkbox" ng-checked="vm.itemSelected[$index]" ng-click="vm.selectItem($event, $index, item)"> {{ $index + 1 }}
        </td>
        <td>{{ item.name }}</td>
        <td>{{ item.method }}</td>
        <td>{{ item.unit }}</td>
        <td>{{ item.standardValue }}</td>
        <td>{{ item.defaultPrice }}</td>
        <td>
          <i class="icon" ng-class="{'initial icon-status-doing': item.status==0,
									'handling icon-status-unhandle': item.status==1,
									'done icon-status-success': item.status==2}">
          </i>
          <span ng-if="item.status == 0">未分配</span>
          <span ng-if="item.status == 1">待检测</span>
          <span ng-if="item.status == 2">检测完成</span>
        </td>
        <td>{{ item.subpackage === '1' ? '是' : '否' }}</td>
        <td>{{ item.testRoom || '--' }}</td>
        <td>{{ item.testUser || '--' }}</td>
        <td>{{ item.updatedAt | date:'yyyy-MM-dd hh:mm:ss' }}</td>
        <td>
          <button class="btn btn-default" ng-click="vm.distribute(item)">
            <i class="icon icon-distribute"></i>
            <span>分配</span>
          </button>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="12">
          <div st-idp st-total-count="vm.total"></div>
        </td>
      </tr>
    </tfoot>
  </table>
</div>
