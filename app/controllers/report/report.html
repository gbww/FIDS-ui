<div class="report-list">
	<div>
		<bread-crumb link-data="vm.breadCrumbArr"></bread-crumb>
		<div class="pt-2">
			<div class="toolbar clearfix">
				<ul class="statusBar clearfix">
					<li ng-class="{'active': vm.status === 0}">
						<a ng-click="vm.searchStatus(0)">
							<i class="fa fa-edit"></i>
							<span>待编辑</span>
						</a>
					</li>
					<li ng-class="{'active': vm.status === 1}">
						<a ng-click="vm.searchStatus(1)">
							<i class="icon icon-inspection"></i>
							<span>待审核</span>
						</a>
					</li>
					<li ng-class="{'active': vm.status === 2}">
						<a ng-click="vm.searchStatus(2)">
							<i class="icon icon-approve"></i>
							<span>待批准</span>
						</a>
					</li>
					<li ng-class="{'active': vm.status === 3}">
						<a ng-click="vm.searchStatus(3)">
							<i class="fa fa-print"></i>
							<span>待打印</span>
						</a>
					</li>
					<li ng-class="{'active': vm.status === 4}">
						<a ng-click="vm.searchStatus(4)">
							<i class="icon icon-finished-list"></i>
							<span>完成</span>
						</a>
					</li>
					<li ng-class="{'active': vm.status === 5}">
						<a ng-click="vm.searchStatus(5)">
							<i class="icon icon-all-list"></i>
							<span>所有</span>
						</a>
					</li>
				</ul>

				<div class="pull-right" ng-show="!vm.advance">
					<input class="input" placeholder="请输入报告编号查询" ng-model="vm.searchConditions.reportId" ng-keyup="vm.eventSearch($event)">
					<button class="btn btn-default-dark" ng-click="vm.search()">
						<i class="fa fa-search"></i>
						<span>查询</span>
					</button>
					<a href ng-click="vm.advance = true">
						<span>展开</span>&nbsp;
						<i class="fa fa-chevron-down"></i>
					</a>
				</div>
				<div class="advanced-search clearfix" ng-show="vm.advance">
					<div class="clearfix">
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.reportIdArr" model="vm.searchConditions" key="reportId" placeholder="报告编号"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.sampleNameArr" model="vm.searchConditions" key="sampleName" placeholder="样品名称"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.entrustedUnitArr" model="vm.searchConditions" key="entrustedUnit" placeholder="委托单位"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.inspectedUnitArr" model="vm.searchConditions" key="inspectedUnit" placeholder="受检单位"></div>
						</div>
					</div>
					<div class="clearfix">
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.productionUnitArr" model="vm.searchConditions" key="productionUnit" placeholder="生产单位"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.sampleIdArr" model="vm.searchConditions" key="receiveSampleId" placeholder="抽样单编号"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.exeStandardArr" model="vm.searchConditions" key="executeStandard" placeholder="执行标准"></div>
						</div>
						<button class="btn btn-default-dark pull-left" ng-click="vm.search()">
							<i class="fa fa-search"></i>
							<span>查询</span>
						</button>
						<button class="btn btn-default-dark pull-left" ng-click="vm.reset()">
							<i class="fa fa-refresh"></i>
							<span>重置</span>
						</button>
						<a href class="pull-left" ng-click="vm.back()">
							<span>收起</span>&nbsp;
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
			</div>

			<table class="pt-table" st-table="vm.samples" st-pipe="vm.getSampleList">
				<thead st-search-watch="vm.searchObject">
					<tr>
						<th st-sort="sampleType">报告编号<i class="fa fa-sort"></i></th>
						<th>样品名称</th>
						<th>委托单位</th>
						<th>开始时间</th>
						<th>结束时间</th>
						<th st-sort="createdAt">创建时间<i class="fa fa-sort"></i></th>
						<th>状态</th>
						<th style="width:140px">操作</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-if="vm.loading">
						<td colspan="8" class="text-center"><i class="fa fa-pluse fa-spinner"></i></td>
					</tr>
					<tr ng-if="!vm.loading && vm.samples.length === 0">
						<td colspan="8" class="text-center">暂无报告</td>
					</tr>
					<tr ng-repeat="sample in vm.samples track by $index" ng-if="!vm.loading">
						<td>{{ sample.reportId }}</td>
						<td>{{ sample.sampleName }}</td>
						<td>{{ sample.entrustedUnit }}</td>
						<td>{{ sample.receiveDate }}</td>
						<td>{{ sample.finishDate }}</td>
						<td>{{ sample.createdAt | date:'yyyy-MM-dd HH:mm:ss' }}</td>
						<td>
							<i class="icon"
								ng-class="{'initial icon-status-edit': sample.reportStatus==0,
								'handling icon-status-update': sample.reportStatus==1,
								'approving icon-status-distribute': sample.reportStatus==2,
								'printing icon-status-doing': sample.reportStatus==3,
								'done icon-status-success': sample.reportStatus==4}">
							</i>
							<span ng-if="sample.reportStatus == 0">待编辑</span>
							<span ng-if="sample.reportStatus == 1">待审核</span>
							<span ng-if="sample.reportStatus == 2">待批准</span>
							<span ng-if="sample.reportStatus == 3">待打印</span>
							<span ng-if="sample.reportStatus == 4">完成</span>
						</td>
						<td class="dropdown-col">
							<div class="btn-group">
								<button class="btn btn-default" ui-sref="app.report.detail.info({id: sample.receiveSampleId})" ng-if="sample.reportStatus < 3">
									<i class="fa fa-edit" ng-if="sample.reportStatus == 0"></i>
									<i class="icon icon-inspection" ng-if="sample.reportStatus == 1"></i>
									<i class="icon icon-approve" ng-if="sample.reportStatus == 2"></i>
									<span ng-if="sample.reportStatus == 0">编辑</span>
									<span ng-if="sample.reportStatus == 1">审核</span>
									<span ng-if="sample.reportStatus == 2">批准</span>
								</button>
								<button class="btn btn-default" ng-click="vm.preview(sample)" ng-if="sample.reportStatus >= 3">
									<i class="fa fa-file-pdf-o"></i>
									<span>预览</span>
								</button>
								<button class="btn dropdown-toggle" data-toggle="dropdown">
									<i class="caret"></i>
								</button>
								<ul class="dropdown-menu">
									<li ng-click="vm.export(sample)">
										<a href><i class="fa fa-file-excel-o"></i><span>导出</span></a>
									</li>
									<li ng-click="vm.preview(sample)" ng-if="sample.reportStatus != 3">
										<a href><i class="fa fa-file-pdf-o"></i><span>预览</span></a>
									</li>
								</ul>
							</div>
						</td>
					</tr>
				</tbody>
				<tfoot>
					<tr>
						<td colspan="8">
							<div st-idp st-total-count="vm.total"></div>
						</td>
					</tr>
				</tfoot>
			</table>
		</div>
	</div>
</div>
