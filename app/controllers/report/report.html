<div class="report-list">
	<div>
		<bread-crumb link-data="vm.breadCrumbArr"></bread-crumb>
		<div class="pt-2">
			<div class="toolbar clearfix">

				<div class="pull-right" ng-show="!vm.advance">
					<input class="input" placeholder="请输入抽样单编号查询" ng-model="vm.searchConditions.receivesampleid" ng-keyup="vm.eventSearch($event)">
					<button class="btn btn-default-dark" ng-click="vm.search()">查询</button>
					<a href ng-click="vm.advance = true"><span>展开</span>&nbsp;<i class="fa fa-chevron-down"></i></a>
				</div>
				<div class="advanced-search clearfix" ng-show="vm.advance">
					<div class="clearfix">
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.sampleIdArr" model="vm.searchConditions" key="receivesampleid" placeholder="抽样单编号"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.sampleTypeArr" model="vm.searchConditions" key="sampletype" placeholder="样品类别"></div>
						</div>
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.checkTypeArr" model="vm.searchConditions" key="checktype" placeholder="检验类型"></div>
						</div>
					</div>
					<div class="clearfix">
						<div class="col-sm-3">
							<div custom-select avail-arr="vm.entrustedUnitArr" model="vm.searchConditions" key="entrustedunit" placeholder="委托单位"></div>
						</div>
						<div class="col-sm-3">
							<input class="input date" ng-model="vm.searchConditions.startTime" placeholder="开始时间" datepicker>
						</div>
						<div class="col-sm-3">
							<input class="input date" ng-model="vm.searchConditions.endTime" placeholder="结束时间" datepicker>
						</div>
						<button class="btn btn-default-dark pull-left" ng-click="vm.search()">查询</button>
						<a href class="pull-left" ng-click="vm.back()"><span>收起</span>&nbsp;<i class="fa fa-chevron-up"></i></a>
					</div>
				</div>
			</div>

			<table class="pt-table" st-table="vm.samples" st-pipe="vm.getSampleList">
				<thead st-search-watch="vm.searchObject">
					<tr>
						<th>抽样单编号</th>
						<th>协议编号</th>
						<th st-sort="sampleType">样品类别<i class="fa fa-sort"></i></th>
						<th st-sort="checkType">检验类型<i class="fa fa-sort"></i></th>
						<th>委托单位</th>
						<th>执行标准</th>
						<th st-sort="createdAt">创建时间<i class="fa fa-sort"></i></th>
						<th>状态</th>
						<th style="width:140px">操作</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-if="vm.loading">
						<td colspan="9" class="text-center"><i class="fa fa-pluse fa-spinner"></i></td>
					</tr>
					<tr ng-if="!vm.loading && vm.samples.length === 0">
						<td colspan="9" class="text-center">暂无接样单</td>
					</tr>
					<tr ng-repeat="sample in vm.samples track by $index" ng-if="!vm.loading">
						<td>{{ sample.receiveSampleId }}</td>
						<td>{{ sample.protocolId }}</td>
						<td>{{ sample.sampleType }}</td>
						<td>{{ sample.checkType }}</td>
						<td>{{ sample.entrustedUnit }}</td>
						<td>{{ sample.executeStandard }}</td>
						<td>{{ sample.createdAt | date:'yyyy-MM-dd HH:mm:ss' }}</td>
						<td>
							<span ng-if="sample.reportStatus == 0">待编辑</span>
							<span ng-if="sample.reportStatus == 1">待审核</span>
							<span ng-if="sample.reportStatus == 2">待批准</span>
							<span ng-if="sample.reportStatus == 3">完成</span>
						</td>
						<td class="dropdown-col">
							<div class="btn-group">
								<button class="btn btn-default" ng-click="vm.goDetail(sample.receiveSampleId)" ng-if="sample.reportStatus != 3">
									<i class="fa fa-edit" ng-if="sample.reportStatus == 0"></i>
									<i class="icon icon-inspection" ng-if="sample.reportStatus == 1"></i>
									<i class="icon icon-approve" ng-if="sample.reportStatus == 2"></i>
									<span ng-if="sample.reportStatus == 0">编辑</span>
									<span ng-if="sample.reportStatus == 1">审核</span>
									<span ng-if="sample.reportStatus == 2">批准</span>
								</button>
								<button class="btn btn-default" ng-click="vm.preview(sample)" ng-if="sample.reportStatus == 3">
									<i class="fa fa-edit"></i>
									<span>预览</span>
								</button>
								<button class="btn dropdown-toggle" data-toggle="dropdown">
									<i class="caret"></i>
								</button>
								<ul class="dropdown-menu">
									<li ng-click="vm.export(sample)">
										<a href><i class="fa fa-file-excel-o"></i><span>导出</span></a>
									</li>
									<li ng-click="vm.preview(sample)" ng-if="sample.reportStatus != 3">
										<a href><i class="fa fa-file-pdf-o"></i><span>预览</span></a>
									</li>
								</ul>
							</div>
						</td>
					</tr>
				</tbody>
				<tfoot>
					<tr>
						<td colspan="9">
							<div st-idp st-total-count="vm.total"></div>
						</td>
					</tr>
				</tfoot>
			</table>
		</div>
	</div>
</div>
